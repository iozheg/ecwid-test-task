var U=i=>{throw TypeError(i)};var B=(i,e,t)=>e.has(i)||U("Cannot "+t);var o=(i,e,t)=>(B(i,e,"read from private field"),t?t.call(i):e.get(i)),b=(i,e,t)=>e.has(i)?U("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t),d=(i,e,t,s)=>(B(i,e,"write to private field"),s?s.call(i,t):e.set(i,t),t),g=(i,e,t)=>(B(i,e,"access private method"),t);import{Q as X,u as Y,V as z,a as j,b as ee,p as te}from"./productsQueryOptions-DQgLWmz-.js";import{ae as se,af as H,ag as re,ah as ie,h as V,aa as T,ai as ae,s as ne,w as N,Z as oe,aj as ue,a0 as ce,a3 as F,a4 as le,ak as D,a7 as O,a8 as _,c as C,ab as de,S as he,a6 as I,G as J,ac as K}from"./index-DS8axz3x.js";import{_ as pe,c as fe}from"./ProductItem.vue_vue_type_script_setup_true_lang-DYtn72Sc.js";import{V as me}from"./VSheet-DjPBSNyV.js";import{D as be,i as ge,C as ye,E as ve}from"./VContainer-36dS9OQ4.js";import"./VCard-C7p34-w_.js";import"./VAvatar-D4evxYIQ.js";function G(i,e){const t=new Set(e);return i.filter(s=>!t.has(s))}function Re(i,e,t){const s=i.slice(0);return s[e]=t,s}var Q,h,w,k,f,v,x,E,q,l,M,$,L,P,A,Z,_e=(Z=class extends se{constructor(e,t,s){super();b(this,l);b(this,Q);b(this,h);b(this,w);b(this,k);b(this,f);b(this,v);b(this,x);b(this,E);b(this,q,[]);d(this,Q,e),d(this,k,s),d(this,w,[]),d(this,f,[]),d(this,h,[]),this.setQueries(t)}onSubscribe(){this.listeners.size===1&&o(this,f).forEach(e=>{e.subscribe(t=>{g(this,l,P).call(this,e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,o(this,f).forEach(e=>{e.destroy()})}setQueries(e,t){d(this,w,e),d(this,k,t),H.batch(()=>{const s=o(this,f),n=g(this,l,L).call(this,o(this,w));d(this,q,n),n.forEach(a=>a.observer.setOptions(a.defaultedQueryOptions));const r=n.map(a=>a.observer),c=r.map(a=>a.getCurrentResult()),u=r.some((a,p)=>a!==s[p]),y=s.length===r.length&&!u?c.some((a,p)=>{const m=o(this,h)[p];return!m||!re(a,m)}):!0;!u&&!y||(u&&d(this,f,r),d(this,h,c),this.hasListeners()&&(u&&(G(s,r).forEach(a=>{a.destroy()}),G(r,s).forEach(a=>{a.subscribe(p=>{g(this,l,P).call(this,a,p)})})),g(this,l,A).call(this)))})}getCurrentResult(){return o(this,h)}getQueries(){return o(this,f).map(e=>e.getCurrentQuery())}getObservers(){return o(this,f)}getOptimisticResult(e,t){const s=g(this,l,L).call(this,e),n=s.map(r=>r.observer.getOptimisticResult(r.defaultedQueryOptions));return[n,r=>g(this,l,$).call(this,r??n,t),()=>g(this,l,M).call(this,n,s)]}},Q=new WeakMap,h=new WeakMap,w=new WeakMap,k=new WeakMap,f=new WeakMap,v=new WeakMap,x=new WeakMap,E=new WeakMap,q=new WeakMap,l=new WeakSet,M=function(e,t){return t.map((s,n)=>{const r=e[n];return s.defaultedQueryOptions.notifyOnChangeProps?r:s.observer.trackResult(r,c=>{t.forEach(u=>{u.observer.trackProp(c)})})})},$=function(e,t){return t?((!o(this,v)||o(this,h)!==o(this,E)||t!==o(this,x))&&(d(this,x,t),d(this,E,o(this,h)),d(this,v,ie(o(this,v),t(e)))),o(this,v)):e},L=function(e){const t=new Map(o(this,f).map(n=>[n.options.queryHash,n])),s=[];return e.forEach(n=>{const r=o(this,Q).defaultQueryOptions(n),c=t.get(r.queryHash);c?s.push({defaultedQueryOptions:r,observer:c}):s.push({defaultedQueryOptions:r,observer:new X(o(this,Q),r)})}),s},P=function(e,t){const s=o(this,f).indexOf(e);s!==-1&&(d(this,h,Re(o(this,h),s,t)),g(this,l,A).call(this))},A=function(){var e;if(this.hasListeners()){const t=o(this,v),s=g(this,l,M).call(this,o(this,h),o(this,q)),n=g(this,l,$).call(this,s,(e=o(this,k))==null?void 0:e.combine);t!==n&&H.batch(()=>{this.listeners.forEach(r=>{r(o(this,h))})})}},Z);function Oe({queries:i,...e},t){const s=Y(),n=V(()=>T(i).map(p=>{var S;const m=ae(p);typeof m.enabled=="function"&&(m.enabled=p.enabled());const R=s.defaultQueryOptions(m);return R._optimisticResults=(S=s.isRestoring)!=null&&S.value?"isRestoring":"optimistic",R})),r=new _e(s,n.value,e),c=()=>{const[a,p]=r.getOptimisticResult(n.value,e.combine);return p(a.map((m,R)=>({...m,refetch:async(...S)=>{const[{[R]:W}]=r.getOptimisticResult(n.value,e.combine);return W.refetch(...S)}})))},u=ne(c());let y=()=>{};return s.isRestoring&&N(s.isRestoring,a=>{a||(y(),y=r.subscribe(()=>{u.value=c()}),u.value=c())},{immediate:!0}),N(n,a=>{r.setQueries(a,e),u.value=c()}),oe(()=>{y()}),e.shallow?ue(u):ce(u)}const Ce=F({__name:"CategoryListItem",props:{category:{},products:{}},setup(i){const e=i,t=c=>{console.log("Adding to cart:",c)},s=le(),n=c=>{s.push(`/category/${c.id}`)},r=c=>{s.push(`/product/${c.id}`)};return(c,u)=>(O(),D(me,{rounded:""},{default:_(()=>[C(be,{"align-items":"left",class:"pl-0 pr-0"},{default:_(()=>[C(z,null,{default:_(()=>[C(j,null,{default:_(()=>[C(ge,{variant:"flat",size:"large",onClick:u[0]||(u[0]=y=>n(e.category))},{default:_(()=>[de(he(e.category.name),1)]),_:1})]),_:1})]),_:1}),C(z,null,{default:_(()=>[(O(!0),I(J,null,K(e.products,y=>(O(),D(j,{key:y.id,cols:"6",sm:"6",md:"4"},{default:_(()=>[C(pe,{product:y,onAddToCart:t,onProductClicked:u[1]||(u[1]=a=>r(a))},null,8,["product"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}))}}),Qe=F({__name:"CategoriesList",setup(i){const{setTitle:e}=ye();e("Categories");const{setBreadcrumbs:t}=ve();t([]);const{data:s}=ee(fe({responseFields:["id","name","parentId"]})),n=V(()=>s.value?s.value.items.filter(u=>!u.parentId):[]),r=V(()=>n.value.map(u=>u.id)),c=Oe({queries:V(()=>r.value.map(u=>te({categoryId:u,limit:3,responseFields:["id","name","defaultDisplayedPriceFormatted","sku","imageUrl"]})))});return(u,y)=>(O(),I("div",null,[(O(!0),I(J,null,K(T(n),(a,p)=>{var m,R;return O(),D(Ce,{key:a.id,category:a,products:((R=(m=T(c)[p])==null?void 0:m.data)==null?void 0:R.items)||[]},null,8,["category","products"])}),128))]))}}),Be=F({__name:"index",setup(i){return(e,t)=>(O(),D(Qe))}});export{Be as default};
